<?xml version="1.0" encoding="utf-8"?>
<?xml-model href="rfc7991bis.rnc"?>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!DOCTYPE rfc [
<!ENTITY nbsp "&#160;">
<!ENTITY zwsp "&#8203;">
<!ENTITY nbhy "&#8209;">
<!ENTITY wj "&#8288;">
]>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" category="info" docName="draft-many-tiptop-email-00" ipr="trust200902" obsoletes="" updates="" submissionType="IETF" xml:lang="en" version="3">
  <front>
    <title abbrev="Email in Deep Space">Deploying and Using Email in Deep Space</title>
    <seriesInfo name="Internet-Draft" value="draft-many-tiptop-email-00"/>
    <author fullname="Marc Blanchet" initials="MB">
      <organization>Viagenie</organization>
      <address>
        <postal>
          <country>Canada</country>
        </postal>
        <email>marc.blanchet@viagenie.ca</email>
      </address>
    </author>
    <area>Internet</area>
    <workgroup>Internet Engineering Task Force</workgroup>
    <keyword>dtn</keyword>
    <keyword>email</keyword>
    <keyword>space</keyword>
    <keyword>deep space</keyword>
    <keyword>smtp</keyword>
    <keyword>jmap</keyword>
    <abstract>
      <t>This document is an assessment on the email protocols to be used in deep space and provides recommendations to deploy and use email in deep space.</t>
    </abstract>
  </front>
  <middle>
    <section>
      <name>Introduction</name>
      <t>Deep space communications involve long delays (e.g. Earth to Mars is 4-22 minutes) and intermittent communications, because of orbital dynamics. As discussed in <xref target="I-D.many-tiptop-ip-architecture"/>, IP packets are stored by forwarders facing intermittent links, instead of dropping them. So packets may take a long time to arrive at destination, such as minutes, hours, days, weeks. The QUIC transport protocol, profiled for space delays, is used for reliable transport.</t>
      <section anchor="requirements">
        <name>Requirements Language</name>
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
          RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
          interpreted as described in BCP 14 <xref target="RFC2119"/>
          <xref target="RFC8174"/> when, and only when, they appear in
          all capitals, as shown here.</t>
      </section>
      <section>
        <name>Document and Discussion Locations</name>
        <t>The source of this document is located at https://github.com/marcblanchet/draft-tiptop-email. Comments or changes are welcomed by filing a PR or an issue against that repository.</t>
        <t>This subject should be discussed on the IETF tiptop working group mailing list.</t>
      </section>
    </section>
    <section>
        <name>Deploying Email in Deep Space Assessment</name>
        <t>On Internet, to send an email, the SMTP protocol is used over TCP. Prior to sending, the IP address of the recipient server is found by quering the MX records and then the IP address records (A, AAAA) of the MX returned values. SMTP goes through a series of messages between the client and the server to exchange capabilities, sender and recipient email addresses and then content of the email, which results to multiple RTT to send the whole email. To get its email, a user uses IMAP or POP, both over TCP. Given TCP is not appropriate for deep space links<xref target="I-D.many-tiptop-usecase"/>, another solution has to be found.</t>
        <t>A more recent email protocol is JMAP <xref target="RFC8621"/> which uses REST over HTTP. In deep space, JMAP could be run over HTTP3/QUIC with QUIC properly profiled<xref target="I-D.many-tiptop-quic-profile"/>.</t>
        <t>DNS insfrastructure need to be properly deployed and setup to avoid DNS requests through deep space links<xref target="I-D.many-tiptop-dns"/>.</t>
    </section>
    <section>
      <name>Deployment Recommendations</name>
      <t>On Earth, current SMTP infrastructure is used. For email to be forwarded to space, an Earth mail gateway, as the last hop for email on Earth, receives emails by SMTP, converts the email to Batch SMTP MIME object <xref target="RFC2442"/>, sends using REST/HTTP3/QUIC to the corresponding gateway on the celestial body surface network. In this scenario, given the low number of celestial body networks, the use of DNS lookup of MX and IP address records may be avoided by having a static map of destination domains to HTTP endpoints, configured on the Earth mail gateway.</t>
      <t>Reversely, an email sent from a celestial body surface network would be forwarded to the SMTP gateway on that network. The SMTP gateway converts the email to Batch SMTP MIME object <xref target="RFC2442"/>, sends using REST/HTTP3/QUIC to the corresponding gateway on Earth. The Earth endpoint may be statically configured on the celestial body gateway.</t>
    </section>
    <section>
      <name>DNS Considerations</name>
      <t>For emails sent from Earth, if the DNS is used, the looked up MX records and their corresponding IP address records should point to the gateway on the target celestial body network. Those records should be located or cached on the DNS infrastructure on Earth.</t>
      <t>Similarly, if the DNS is used, it is assumed that on the celestial body network, there will be a local DNS infrastructure that has a cache of the related records, as discussed in <xref target="I-D.many-tiptop-dns"/>.</t>
      <t>Mail headers such as Received and others contain domain names. It is recommended to not lookup those names on the celestial body gateway.</t>
    </section>
    <section>
        <name>Unwanted Email Considerations</name>
        <t>To minimize use of scarce deep space bandwidth, strong anti-spamming should be done before leaving Earth.</t>
        <t>An anti-spamming system on the celestial body network should not rely on any database or DNS lookup located on Earth.</t>
    </section>
    <section anchor="IANA">
      <name>IANA Considerations</name>
      <t>This memo includes no request to IANA.</t>
    </section>
    <section anchor="Security">
      <name>Security Considerations</name>
      <t>TBD</t>
    </section>
  </middle>
  <back>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.2442.xml"/>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8174.xml"/>
      </references>
      <references>
        <name>Informative References</name>
        <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8621.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.many-tiptop-ip-architecture.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.many-tiptop-dns.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.many-tiptop-quic-profile.xml"/>
      </references>
    </references>
    <section anchor="Acknowledgements" numbered="false">
      <name>Acknowledgements</name>
      <t>Initial discussions on this subject were with John Levine and Pete Resnick.</t>
    </section>
  </back>
</rfc>
